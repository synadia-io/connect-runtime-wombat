model_version: "1"
name: file
label: File
kind: source
status: stable
description: >-
  Consumes data from files on disk, emitting messages according to a chosen codec.
  
  ## Metadata

  This input adds the following metadata fields to each message:

  ```text
  - path
  - mod_time_unix
  - mod_time (RFC3339)
  ```
fields:
  - path: paths
    name: paths
    label: Paths
    type: string
    kind: list
    description: >-
      A list of paths to consume sequentially. Glob patterns are supported, including super globs (double star).

  - path: scanner
    name: scanner
    label: Scanner
    type: scanner
    description: >-
      The scanner by which the stream of bytes consumed will be broken out into individual messages. Scanners are 
      useful for processing large sources of data without holding the entirety of it within memory. For example, 
      the `csv` scanner allows you to process individual CSV rows without loading the entire CSV file in memory at once.
    default: {"lines":{}}
    optional: true

  - path: delete_on_finish
    name: delete_on_finish
    label: Delete on Finish
    type: bool
    description: >-
      Whether to delete the file after it has been fully consumed.
    default: false
    optional: true

  - path: auto_replay_nacks
    name: auto_replay_nacks
    label: Auto Replay Nacks
    type: bool
    description: >-
      Whether messages that are rejected (nacked) at the output level should be automatically replayed indefinitely, 
      eventually resulting in back pressure if the cause of the rejections is persistent. If set to `false` these 
      messages will instead be deleted. Disabling auto replays can greatly improve memory efficiency of high 
      throughput streams as the original shape of the data can be discarded immediately upon consumption and mutation.
    default: false
    optional: true
