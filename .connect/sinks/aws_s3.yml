model_version: '1'
kind: sink
label: AWS S3
name: aws_s3
icon:
  data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgd2lkdGg9IjMxMCIKICAgaGVpZ2h0PSIzMTAiCiAgIHZpZXdCb3g9IjAgMCAzMTAgMzEwIgogICB2ZXJzaW9uPSIxLjEiCiAgIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIgogICBpZD0ic3ZnMjgiCiAgIHNvZGlwb2RpOmRvY25hbWU9ImF3cy1zMy5zdmciCiAgIGlua3NjYXBlOnZlcnNpb249IjEuMSAoMToxLjErMjAyMTA1MjYxNTE3K2NlNjY2M2IzYjcpIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMzMiIgLz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9Im5hbWVkdmlldzMwIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VjaGVja2VyYm9hcmQ9IjAiCiAgICAgc2hvd2dyaWQ9ImZhbHNlIgogICAgIHdpZHRoPSIzMTBweCIKICAgICBpbmtzY2FwZTp6b29tPSIxLjQ0Njc3NDIiCiAgICAgaW5rc2NhcGU6Y3g9IjQ0LjU4MTk0IgogICAgIGlua3NjYXBlOmN5PSIxOTUuNjA3NTgiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxOTIwIgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjEwMTYiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjI3IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ic3ZnMjgiIC8+CiAgPGcKICAgICBpZD0iZzI2IgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI3LDAuMjg2KSI+CiAgICA8cGF0aAogICAgICAgZD0iTSAyMC42MjQsNTMuNjg2IDAsNjQgdiAxODEuMDIgbCAyMC42MjQsMTAuMjU0IDAuMTI0LC0wLjE0OSBWIDUzLjgyOCBsIC0wLjEyNCwtMC4xNDIiCiAgICAgICBmaWxsPSIjOGMzMTIzIgogICAgICAgaWQ9InBhdGgyIiAvPgogICAgPHBhdGgKICAgICAgIGQ9Ik0gMTMxLDIyOSAyMC42MjQsMjU1LjI3NCBWIDUzLjY4NiBMIDEzMSw3OS4zODcgViAyMjkiCiAgICAgICBmaWxsPSIjZTA1MjQzIgogICAgICAgaWQ9InBhdGg0IiAvPgogICAgPHBhdGgKICAgICAgIGQ9Im0gODEuMTc4LDE4Ny44NjYgNDYuODE4LDUuOTYgMC4yOTQsLTAuNjc4IDAuMjYzLC03Ni43NyAtMC41NTcsLTAuNiAtNDYuODE4LDUuODc0IHYgNjYuMjE0IgogICAgICAgZmlsbD0iIzhjMzEyMyIKICAgICAgIGlkPSJwYXRoNiIgLz4KICAgIDxwYXRoCiAgICAgICBkPSJtIDEyNy45OTYsMjI5LjI5NSAxMDcuMzcxLDI2LjAzNSAwLjE2OSwtMC4yNjkgLTAuMDAzLC0yMDEuMTk1IC0wLjE3LC0wLjE4IC0xMDcuMzY3LDI1Ljk5NiB2IDE0OS42MTMiCiAgICAgICBmaWxsPSIjOGMzMTIzIgogICAgICAgaWQ9InBhdGg4IiAvPgogICAgPHBhdGgKICAgICAgIGQ9Im0gMTc0LjgyNywxODcuODY2IC00Ni44MzEsNS45NiB2IC03OC4wNDggbCA0Ni44MzEsNS44NzQgdiA2Ni4yMTQiCiAgICAgICBmaWxsPSIjZTA1MjQzIgogICAgICAgaWQ9InBhdGgxMCIgLz4KICAgIDxwYXRoCiAgICAgICBkPSJtIDE3NC44MjcsODkuNjMxIC00Ni44MzEsOC41MzUgLTQ2LjgxOCwtOC41MzUgNDYuNzU5LC0xMi4yNTYgNDYuODksMTIuMjU2IgogICAgICAgZmlsbD0iIzVlMWYxOCIKICAgICAgIGlkPSJwYXRoMTIiIC8+CiAgICA8cGF0aAogICAgICAgZD0ibSAxNzQuODI3LDIxOS44MDEgLTQ2LjgzMSwtOC41OTEgLTQ2LjgxOCw4LjU5MSA0Ni43NjEsMTMuMDUzIDQ2Ljg4OCwtMTMuMDUzIgogICAgICAgZmlsbD0iI2YyYjBhOSIKICAgICAgIGlkPSJwYXRoMTQiIC8+CiAgICA8cGF0aAogICAgICAgZD0ibSA4MS4xNzgsODkuNjMxIDQ2LjgxOCwtMTEuNTg2IDAuMzc5LC0wLjExNyBWIDAuMzEzIEwgMTI3Ljk5NiwwIDgxLjE3OCwyMy40MTMgdiA2Ni4yMTgiCiAgICAgICBmaWxsPSIjOGMzMTIzIgogICAgICAgaWQ9InBhdGgxNiIgLz4KICAgIDxwYXRoCiAgICAgICBkPSJNIDE3NC44MjcsODkuNjMxIDEyNy45OTYsNzguMDQ1IFYgMCBsIDQ2LjgzMSwyMy40MTMgdiA2Ni4yMTgiCiAgICAgICBmaWxsPSIjZTA1MjQzIgogICAgICAgaWQ9InBhdGgxOCIgLz4KICAgIDxwYXRoCiAgICAgICBkPSJNIDEyNy45OTYsMzA5LjQyOCA4MS4xNzMsMjg2LjAyMyB2IC02Ni4yMTcgbCA0Ni44MjMsMTEuNTgyIDAuNjg5LDAuNzgzIC0wLjE4Nyw3NS45MDYgLTAuNTAyLDEuMzUxIgogICAgICAgZmlsbD0iIzhjMzEyMyIKICAgICAgIGlkPSJwYXRoMjAiIC8+CiAgICA8cGF0aAogICAgICAgZD0ibSAxMjcuOTk2LDMwOS40MjggNDYuODI3LC0yMy40MDUgdiAtNjYuMjE3IGwgLTQ2LjgyNywxMS41ODIgdiA3OC4wNCIKICAgICAgIGZpbGw9IiNlMDUyNDMiCiAgICAgICBpZD0icGF0aDIyIiAvPgogICAgPHBhdGgKICAgICAgIGQ9Ik0gMjM1LjM2Nyw1My42ODYgMjU2LDY0IHYgMTgxLjAyIGwgLTIwLjYzMywxMC4zMSBWIDUzLjY4NiIKICAgICAgIGZpbGw9IiNlMDUyNDMiCiAgICAgICBpZD0icGF0aDI0IiAvPgogIDwvZz4KPC9zdmc+Cg==
status: stable
description: >-
  Sends message parts as objects to an Amazon S3 bucket. Each object is
  uploaded with the path specified with the `path` field.
fields:
  - path: bucket
    name: bucket
    label: Bucket
    type: string
    description: >-
      The bucket to upload messages to.
  - path: path
    name: path
    label: Path
    type: expression
    default: ${!counter()}-${!timestamp_unix_nano()}.txt
    optional: true
    examples:
      - ${!count("files")}-${!timestamp_unix_nano()}.txt
      - ${!meta("kafka_key")}.json
      - ${!json("doc.namespace")}/${!json("doc.id")}.json

    description: >-
      The path of each message to upload.
  - path: tags
    name: tags
    label: Tags
    kind: map
    type: expression
    default: {}
    optional: true
    examples:
      - Key1: Value1
        Timestamp: ${!meta("Timestamp")}

    description: >-
      Key/value pairs to store with the object as tags.
  - path: content_type
    name: content_type
    label: Content Type
    type: string
    default: application/octet-stream
    optional: true
    description: >-
      The content type to set for each object.
  - path: content_encoding
    name: content_encoding
    label: Content Encoding
    type: string
    optional: true
    description: >-
      An optional content encoding to set for each object.
  - path: cache_control
    name: cache_control
    label: Cache Control
    type: string
    optional: true
    description: >-
      The cache control to set for each object.
  - path: content_disposition
    name: content_disposition
    label: Content Disposition
    type: string
    optional: true
    description: >-
      The content disposition to set for each object.
  - path: content_language
    name: content_language
    label: Content Language
    type: string
    optional: true
    description: >-
      The content language to set for each object.
  - path: content_md5
    name: content_md5
    label: Content Md5
    type: string
    optional: true
    description: >-
      The content MD5 to set for each object.
  - path: website_redirect_location
    name: website_redirect_location
    label: Website Redirect Location
    type: string
    optional: true
    description: >-
      The website redirect location to set for each object.
  - path: metadata
    name: metadata
    label: Metadata
    type: object
    optional: true
    description: >-
      Specify criteria for which metadata values are attached to objects
      as headers.
    fields:
      - path: metadata.exclude_prefixes
        name: exclude_prefixes
        label: Exclude Prefixes
        type: string
        optional: true
        description: >-
          Provide a list of explicit metadata key prefixes to be excluded when
          adding metadata to sent messages.
  - path: storage_class
    name: storage_class
    label: Storage Class
    type: string
    default: STANDARD
    optional: true
    description: >-
      The storage class to set for each object.
  - path: kms_key_id
    name: kms_key_id
    label: Kms Key ID
    type: string
    optional: true
    description: >-
      An optional server side encryption key.
  - path: server_side_encryption
    name: server_side_encryption
    label: Server Side Encryption
    type: string
    optional: true
    description: >-
      An optional server side encryption algorithm.
  - path: force_path_style_urls
    name: force_path_style_urls
    label: Force Path Style URLs
    type: bool
    default: false
    optional: true
    description: >-
      Forces the client API to use path style URLs, which helps when connecting
      to custom endpoints.
  - path: max_in_flight
    name: max_in_flight
    label: Max In Flight
    type: int
    default: 64
    optional: true
    description: >-
      The maximum number of parallel message batches to have in flight at
      any given time.
  - path: timeout
    name: timeout
    label: Timeout
    type: string
    default: "5s"
    optional: true
    description: >-
      The maximum period to wait on an upload before abandoning it and reattempting.
  - path: region
    name: region
    label: Region
    type: string
    description: >-
      The AWS region to target.
  - path: endpoint
    name: endpoint
    label: Endpoint
    type: string
    optional: true
    description: >-
      Allows you to specify a custom endpoint for the AWS API.
  - path: credentials
    name: credentials
    label: Credentials
    type: object
    description: >-
      Optional manual configuration of AWS credentials to use. More information
      can be found in [the AWS Guide](https://wombat.dev/pipelines/deploy/cloud/aws/).
    fields:
      - path: credentials.id
        name: id
        label: ID
        type: string
        optional: true
        description: >-
          The ID of credentials to use.
      - path: credentials.secret
        name: secret
        label: Secret
        type: string
        optional: true
        description: >-
          The secret for the credentials being used.
      - path: credentials.token
        name: token
        label: Token
        type: string
        optional: true
        description: >-
          The token for the credentials being used, required when using short
          term credentials.
