model_version: "1"
kind: sink
label: Snowflake Put
name: snowflake_put
icon: data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjFlbSIgc3R5bGU9ImZsZXg6bm9uZTtsaW5lLWhlaWdodDoxIgogIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjFlbSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+U25vd2ZsYWtlPC90aXRsZT48cGF0aAogIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIzLjI1MiAxMC4zNjVsLTIuODQzIDEuNjM2IDIuODQzIDEuNjMxYTEuNDcgMS40NyAwIDAxLjY5Ny45MDMgMS40OTIgMS40OTIgMCAwMS0uMTUKICAxLjEzNWMtLjIwMi4zNDItLjUzLjU5MS0uOTEyLjY5M2ExLjQ5OCAxLjQ5OCAwIDAxLTEuMTMyLS4xNWwtNS4wOS0yLjkyNGExLjQ3MyAxLjQ3MyAwIDAxLS42OC0uODUxIDEuNDQ2IDEuNDQ2CiAgMCAwMS0uMDY4LS40ODUgMS41IDEuNSAwIDAxLjc0NS0xLjI0OGw1LjA5LTIuOTIxYTEuNDk2IDEuNDk2IDAgMDEyLjA0NC41NDcgMS40NzkgMS40NzkgMCAwMS0uNTQ0IDIuMDM0em0tMi42OTIKICAgNy45MjdsLTUuMDg3LTIuOTJhMS40NzcgMS40NzcgMCAwMC0uODY3LS4xOTUgMS40NzggMS40NzggMCAwMC0uOTgyLjQ2OGMtLjI1Ny4yNzYtLjQuNjM5LS40MDMgMS4wMTd2NS44NDdBMS40OQogICAxLjQ5IDAgMDAxNC43MTggMjRjLjgyOCAwIDEuNDk3LS42NjggMS40OTctMS40OTF2LTMuMjdsMi44NDkgMS42MzZhMS40OTMgMS40OTMgMCAwMDIuMDQ0LS41NDQgMS40OSAxLjQ5IDAKICAwMC0uNTQ4LTIuMDR6bS01Ljg3LTUuNzE5bC0yLjExNiAyLjEwMmEuNDIuNDIgMCAwMS0uMjY1LjExMmgtLjYyMWEuNDI3LjQyNyAwIDAxLS4yNjUtLjExMmwtMi4xMTUtMi4xMDJhLjQyLjQyCiAgMCAwMS0uMTEtLjI2MnYtLjYyYS40My40MyAwIDAxLjExLS4yNjVsMi4xMTQtMi4xMDJhLjQyNi40MjYgMCAwMS4yNjQtLjExaC42MjNhLjQyMi40MjIgMCAwMS4yNjUuMTFsMi4xMTYKICAyLjEwMmEuNDMuNDMgMCAwMS4xMDkuMjY1di42MmEuNDI4LjQyOCAwIDAxLS4xMS4yNjJ6TTEzIDExLjk5YS40NDIuNDQyIDAgMDAtLjExMy0uMjY2bC0uNjEyLS42MDdhLjQzMS40MzEgMAogIDAwLS4yNjYtLjExaC0uMDI0YS40MjYuNDI2IDAgMDAtLjI2NC4xMWwtLjYxMi42MDdhLjQzNi40MzYgMCAwMC0uMTA3LjI2NnYuMDI0YzAKICAuMDg1LjA0Ny4yMDIuMTA3LjI2MmwuNjEyLjYxYy4wNjEuMDYuMTc5LjExLjI2NC4xMWguMDI0YS40MzQuNDM0IDAgMDAuMjY2LS4xMWwuNjEyLS42MWEuNDI5LjQyOSAwCiAgMDAuMTEyLS4yNjJ2LS4wMjR6TTMuNDM2IDUuNzA0bDUuMDg5CiAgMi45MjRjLjI3NC4xNTcuNTc4LjIxOS44NjguMTk1LjM3NS0uMDI2LjcyNi0uMTk0Ljk4My0uNDcuMjU2LS4yNzUuNC0uNjQuNDAzLTEuMDE3VjEuNDg5QzEwLjc4LjY2NyAxMC4xMSAwCiAgOS4yODQgMGMtLjgyOSAwLTEuNDk4LjY2Ny0xLjQ5OCAxLjQ5djMuMjdsLTIuODUtMS42MzlhMS40OTYgMS40OTYgMCAwMC0yLjA0NS41NDYgMS40ODkgMS40ODkgMCAwMC41NDYKICAyLjAzN3ptMTEuMTcgMy4xMTljLjI5LjAyNC41OTQtLjAzOC44NjYtLjE5NWw1LjA4Ny0yLjkyM2ExLjQ3NCAxLjQ3NCAwIDAwLjY5Ny0uOTAzIDEuNDk2IDEuNDk2IDAgMDAtLjE0OS0xLjEzNQogICAxLjQ5NiAxLjQ5NiAwIDAwLTIuMDQ0LS41NDVMMTYuMjE1IDQuNzZWMS40ODlDMTYuMjE1LjY2NyAxNS41NDYgMCAxNC43MTggMGMtLjgzIDAtMS40OTcuNjY3LTEuNDk3CiAgMS40OXY1Ljg0NWExLjQ5MSAxLjQ5MSAwIDAwMS4zODUgMS40ODd6bS01LjIxMyA2LjM1NGExLjQ3OSAxLjQ3OSAwIDAwLS44NjguMTk0bC01LjA4OSAyLjkyYTEuNDc2IDEuNDc2IDAKICAwMC0uNjk2LjkwNSAxLjQ5OCAxLjQ5OCAwIDAwLjE0OCAxLjEzNSAxLjQ5NiAxLjQ5NiAwIDAwMi4wNDQuNTQzbDIuODUxLTEuNjM2djMuMjdjMCAuODI1LjY3IDEuNDkxIDEuNDk4CiAgMS40OTEuODI2IDAgMS40OTYtLjY2NyAxLjQ5Ni0xLjQ5di01Ljg0N2ExLjUgMS41IDAgMDAtLjQwMS0xLjAxNyAxLjQ3NyAxLjQ3NyAwCiAgMDAtLjk4Mi0uNDY4em0tMS4zOC0yLjc0Yy4wNS0uMTU2LjA3Mi0uMzIuMDY4LS40ODRhMS40OTcgMS40OTcgMCAwMC0uNzUxLTEuMjQ4bC01LjA4NC0yLjkyYTEuNDk5IDEuNDk5IDAKICAwMC0yLjA0NS41NDcgMS40ODEgMS40ODEgMCAwMC41NDkgMi4wMzRsMi44NDEgMS42MzZMLjc1IDEzLjYzM2ExLjQ3IDEuNDcgMCAwMC0uNjk4LjkwMyAxLjQ5MiAxLjQ5MiAwIDAwLjE1CiAgMS4xMzVjLjIwMi4zNDMuNTMuNTkyLjkxMi42OTMuMzgyLjEwMi43ODkuMDQ4IDEuMTMyLS4xNWw1LjA4Ni0yLjkyNGMuMzQ1LS4xOTUuNTc3LS41MDUuNjg0LS44NTJ6IgogIGZpbGw9IiMyNDlFREMiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PC9wYXRoPjwvc3ZnPg==
status: preview
description: |
    Sends messages to Snowflake stages and, optionally, calls Snowpipe to load this data into one or more tables.
fields:
    - path: account
      name: account
      label: Account
      kind: scalar
      optional: false
      type: string
      default: ""
      description: |-
        Account name, which is the same as the Account Identifier
        as described [here](https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#where-are-account-identifiers-used).
        However, when using an [Account Locator](https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#using-an-account-locator-as-an-identifier),
        the Account Identifier is formatted as `<account_locator>.<region_id>.<cloud>` and this field needs to be
        populated using the `<account_locator>` part.
    - path: region
      name: region
      label: Region
      kind: scalar
      type: string
      default: ""
      description: |-
        Optional region field which needs to be populated when using
        an [Account Locator](https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#using-an-account-locator-as-an-identifier)
        and it must be set to the `<region_id>` part of the Account Identifier
        (`<account_locator>.<region_id>.<cloud>`).
      examples:
        - us-west-2
      optional: false
    - path: cloud
      name: cloud
      label: Cloud
      kind: scalar
      type: string
      default: ""
      optional: false
      description: |-
        Optional cloud platform field which needs to be populated
        when using an [Account Locator](https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#using-an-account-locator-as-an-identifier)
        and it must be set to the `<cloud>` part of the Account Identifier
        (`<account_locator>.<region_id>.<cloud>`).
      examples:
        - aws
        - gcp
        - azure
    - path: user
      name: user
      label: User
      kind: scalar
      type: string
      description: Username.
      default: ""
      optional: false
    - path: password
      name: password
      label: Password
      kind: scalar
      type: string
      default: ""
      description: An optional password.
      optional: false
      secret: true
    - path: role
      name: role
      label: Role
      kind: scalar
      type: string
      default: ""
      description: Role.
      optional: false
    - path: database
      name: database
      label: Database
      kind: scalar
      type: string
      default: ""
      description: Database.
      optional: false
    - path: warehouse
      name: warehouse
      label: Warehouse
      kind: scalar
      type: string
      default: ""
      optional: false
      description: Warehouse.
    - path: schema
      name: schema
      label: Schema
      kind: scalar
      type: string
      default: ""
      optional: false
      description: Schema.
    - path: stage
      name: stage
      label: Stage
      kind: scalar
      type: string
      default: ""
      description: |-
        Stage name. Use either one of the
        [supported](https://docs.snowflake.com/en/user-guide/data-load-local-file-system-create-stage.html) stage types.
      optional: false
    - path: path
      name: path
      label: Path
      kind: scalar
      type: string
      default: ""
      description: Stage path.
      optional: true
    - path: file_name
      name: file_name
      kind: scalar
      type: string
      default: ""
      description: Stage file name. Will be equal to the Request ID if not set or empty.
      label: File Name
      optional: true
    - path: file_extension
      name: file_extension
      label: File Extension
      kind: scalar
      type: string
      default: ""
      description: Stage file extension. Will be derived from the configured `compression` if not set or empty.
      examples:
        - csv
        - parquet
      optional: true
    - path: upload_parallel_threads
      name: upload_parallel_threads
      label: Upload Parallel Threads
      kind: scalar
      type: int
      default: "4"
      description: Specifies the number of threads to use for uploading files.
      optional: true
    - path: compression
      name: compression
      label: Compression
      kind: scalar
      type: string
      default: "AUTO"
      constraints:
        - enum:
            - AUTO
            - DEFLATE
            - GZIP
            - NONE
            - RAW_DEFLATE
            - ZSTD
      description: Compression type.
      optional: true
    - path: request_id
      name: request_id
      label: Request ID
      kind: scalar
      type: string
      default: ""
      description: Request ID. Will be assigned a random UUID (v4) string if not set or empty.
      optional: true
    - path: snowpipe
      name: snowpipe
      label: Snowpipe
      kind: scalar
      type: string
      default: ""
      description: An optional Snowpipe name. Use the `<snowpipe>` part from `<database>.<schema>.<snowpipe>`.
      optional: false
    - path: client_session_keep_alive
      name: client_session_keep_alive
      label: Client Session Keep Alive
      kind: scalar
      type: bool
      default: "false"
      description: Enable Snowflake keepalive mechanism to prevent the client session from expiring after 4 hours (error 390114).
      optional: true
    - path: batching
      name: batching
      label: Batching
      kind: scalar
      type: object
      description: Allows you to configure a batching policy
      optional: false
      examples:
        - byte_size: 5000
          count: 0
          period: 1s
        - count: 10
          period: 1s
        - check: this.contains("END BATCH")
          count: 0
          period: 1m
      fields:
        - path: batching.count
          name: count
          label: Count
          kind: scalar
          type: int
          default: "0"
          description: A number of messages at which the batch should be flushed. If `0` disables count based batching.
          optional: true
        - path: batching.byte_size
          name: byte_size
          label: Byte Size
          kind: scalar
          type: int
          default: "0"
          description: An amount of bytes at which the batch should be flushed. If `0` disables size based batching.
          optional: true
        - path: batching.period
          name: period
          label: Period
          kind: scalar
          type: string
          optional: true
          default: ""
          description: A period in which an incomplete batch should be flushed regardless of its size.
          examples:
            - 1s
            - 1m
            - 500ms
        - path: batching.check
          name: check
          label: Check
          kind: scalar
          type: string
          optional: true
          default: ""
          description: A Bloblang query that should return a boolean value indicating whether a message should end a batch.
          examples:
            - this.type == "end_of_transaction"
    - path: max_in_flight
      name: max_in_flight
      label: Max In Flight
      kind: scalar
      type: int
      default: "1"
      description: The maximum number of parallel message batches to have in flight at any given time.
      optional: true

